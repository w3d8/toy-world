<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Cart ğŸ›’</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

  <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <img src="Toy World Logo.webp" alt="logo" style="max-height: 50px;">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar" aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="content-background" id="mainNavbar">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" href="index.html">Home ğŸ </a></li>
          <li class="nav-item"><a class="nav-link" href="profile.php">Profile ğŸ‘¤</a></li>
          <li class="nav-item"><a class="nav-link" href="menu.html">Menu ğŸ®</a></li>
          <li class="nav-item"><a class="nav-link" href="cart.html">Cart ğŸ›’</a></li>
          <li class="nav-item"><a class="nav-link" href="FAQ.html">FAQ ğŸ”</a></li>
          <li class="nav-item"><a class="nav-link" href="contact.html">Contact Us ğŸ“</a></li>
          <li class="nav-item"><a class="nav-link" href="logout.html">LogoutğŸ”‘</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-5">
    <h2 class="mb-4 text-center">ğŸ›’ Shopping Cart</h2>

    <div class="table-responsive">
      <table class="table table-bordered align-middle text-center bg-white shadow-sm rounded-3">
        <thead class="table-primary">
          <tr>
            <th>Product</th>
            <th>Qty</th>
            <th>Price</th>
            <th>Subtotal</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="cart-items"></tbody>
      </table>
    </div>

    <div class="text-end">
      <h4>Total: <span id="total-amount">$0.00</span></h4>
      <a href="checkout.php" class="btn btn-success mt-2">Proceed to Checkout</a>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      const tbody = document.getElementById('cart-items');
      let total = 0;

      if (cart.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5">Your cart is empty.</td></tr>';
      } else {
        cart.forEach((item, index) => {
          const subtotal = item.price * item.quantity;
          total += subtotal;

          tbody.innerHTML += `
            <tr>
              <td><img src="${item.image}" width="50"> ${item.name}</td>
              <td>
                <input type="number" class="form-control" min="1" value="${item.quantity}" onchange="updateQuantity(${index}, this.value)">
              </td>
              <td>$${item.price.toFixed(2)}</td>
              <td>$${subtotal.toFixed(2)}</td>
              <td><button onclick="removeItem(${index})" class="btn btn-danger btn-sm">Remove</button></td>
            </tr>
          `;
        });
      }

      document.getElementById("total-amount").innerText = `$${total.toFixed(2)}`;
    });

    function updateQuantity(index, newQuantity) {
      if (newQuantity < 1) newQuantity = 1;  // Ensure quantity is at least 1
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      cart[index].quantity = parseInt(newQuantity);
      localStorage.setItem('cart', JSON.stringify(cart));
      location.reload();  // Reload the page to update the table with the new quantity
    }

    function removeItem(index) {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      cart.splice(index, 1);
      localStorage.setItem('cart', JSON.stringify(cart));
      location.reload();  // Reload the page to reflect the removal
    }
  </script>
</body>
</html>
